\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{setupscript-layout}[2014/08/06 Layout options for setupscript]

% Math definitions/environments, not for beamer
\if@beamer\else
    % NON-FRAMED THEOREMS
    \if@framedtheorem\else
        \theoremstyle{plain}
        \theoremheaderfont{\normalfont\bfseries}\theorembodyfont{\normalfont}
        \theoremseparator{:}
        \newtheorem{definition}{Definition}
        \newtheorem{proposition}{Proposition}
        \newtheorem{theorem}{Theorem}
        \newtheorem{axiom}{Axiom}
        \newtheorem{corollary}{Corollary}
        \newtheorem{lemma}{Lemma}
        \newtheorem{remark}{Remark}
        \newtheorem{example}{Example}
        %Proof
        \theoremstyle{nonumberplain}
        \newtheorem{proof}{Proof}
        \theoremsymbol{\ensuremath{\blacksquare}}
    \fi


    % FRAMED THEOREMS
    \if@framedtheorem
    \mdfsetup{
        framemethod=tikz,
        ntheorem=true
    }
        \mdfdefinestyle{theoremstyle}{%
            linecolor = gray!20,
            linewidth = 1pt,
            innerleftmargin = 5pt,
            innerrightmargin = 5pt,
            innertopmargin = 0pt,
            leftmargin = 0pt,
            rightmargin = 0pt,
            frametitlerule = true,
            frametitlebackgroundcolor = gray!20,
            innertopmargin = \topskip,
            middlelinewidth = 1pt,
            ntheorem = true,
            nobreak = true
        }
        \theorempreskip{5pt}
        \theorempostskip{10pt}
        %Example: \mdtheorem[<mdframedâˆ’options>]{<envname>}[<numberedlike>]{<caption>}[<within>]
        \mdtheorem[style=theoremstyle]{proposition}{Proposition}%[section]
        \mdtheorem[style=theoremstyle]{proof}{Proof}%[section]
        \mdtheorem[style=theoremstyle]{theorem}{Theorem}%[section]
        \mdtheorem[style=theoremstyle]{definition}{Definition}%[section]
        \mdtheorem[style=theoremstyle]{axiom}{Axiom}%[section]
        \mdtheorem[style=theoremstyle]{corollary}{Corollary}%[section]
        \mdtheorem[style=theoremstyle]{lemma}{Lemma}%[section]
        \mdtheorem[style=theoremstyle]{remark}{Remark}%[section]
    \fi
\fi

% Add closing mark to square root signs
% use \oldsqrt for old behavior
\LetLtxMacro{\oldsqrt}{\sqrt}
\renewcommand{\sqrt}[1][\ ]{%
    \def\DHLindex{#1}\mathpalette\DHLhksqrt}
\def\DHLhksqrt#1#2{%
    \setbox0=\hbox{$#1\oldsqrt[\DHLindex]{#2\,}$}\dimen0=\ht0
    \advance\dimen0-0.2\ht0
    \setbox2=\hbox{\vrule height\ht0 depth -\dimen0}%
    {\box0\lower0.71pt\box2}}


%% ############################################################################
%% ##################### MEMOIR ###############################################
%% ############################################################################
\if@memoir

    %%%%%%%%%%%%%
    % PAGE LAYOUT

    \setlrmarginsandblock{30mm}{30mm}{*} % left right margins
    \setulmarginsandblock{35mm}{40mm}{*} % top bottom margins
    \setheadfoot{\onelineskip}{2\onelineskip} % {headheight}{footskip}
    \setheaderspaces{20mm}{*}{*} % {headdrop}{headsep}{ratio}

    % Parskip (not recommended)
    % \setlength{\parindent}{0pt}
    % \nonzeroparskip
    % \abnormalparskip{8pt}
    \setlength{\parindent}{2em} % indentation for new paragraphs
    \setSingleSpace{1.1} % Line spacing

    % PAGE Breaking
    % Dealing with widows and orphans
    \clubpenalty=9996
    \widowpenalty=9999
    \brokenpenalty=4991
    \predisplaypenalty=10000
    \postdisplaypenalty=1549
    \displaywidowpenalty=1602

    %\flushbottom % to stretch vboxes to cover full page (won't always work with figures)
    %\checkandfixthelayout[lines] % use "fixed" with raggedbottom

    % Alternatively:
    \raggedbottom % allow textheight to vary somewhat between pages
    \feetatbottom % to ensure footnotes are still at bottom with \raggedbottom
    \checkandfixthelayout[fixed] % use "fixed" with raggedbottom

    % END
    %%%%%

    \counterwithout{footnote}{chapter} % continous numbering of footnotes

    % Correct numbering without chapters
    \renewcommand{\thesection}{\arabic{section}}
    \renewcommand{\thesubsection}{\thesection.\arabic{subsection}}
    \makeatletter
    \let\l@subsection\l@section
    \let\l@section\l@chapter
    \makeatother
    \setsecnumdepth{subsection} % Numbering subsections

    % Figure Captions (and notes)
    \captionstyle[\centering]{\raggedright} % [short caption]{long caption}
    \captiondelim{. }
    \captionnamefont{\normalsize\sffamily} % \sffamily
    \captiontitlefont{\normalsize\sffamily} % \sffamily

    % To add a note below the figure use \figurenotes{}
    \newcommand{\figurenotes}[1]{%
    \captionstyle[\centering]{} % \raggedright
    \captiontitlefont{\footnotesize\rmfamily}
    \legend{Notes: #1}}

    % Footnote with no number (for e.g. acknowledgements)
    \newcommand\blindfootnote[1]{%
    \begingroup
    \renewcommand\thefootnote{}\footnote{#1}%
    \addtocounter{footnote}{-1}%
    \endgroup
    }

    % % Headstyles for chapter mode (not article)
    % \headstyles{ntglike}
    % \chapterstyle{dash}
    % \setlength{\beforechapskip}{25pt} % Remove extra spacing before chapter
    % \setlength{\midchapskip}{5pt}
    % \setlength{\afterchapskip}{15pt}
    % \renewcommand*{\chapnamefont}{\huge\bfseries}
    % %

    % % Page style
    % \makepagestyle{mypagestyle}
    %     \setheadfoot{30pt}{15pt}
    %     \makeevenhead{mypagestyle}{}{}{}% Even page header
    %     \makeoddhead{mypagestyle}{}{}{}% Odd page header
    %     \makeevenfoot{mypagestyle}{}{\thepage}{}% Even page footer
    %     \makeoddfoot{mypagestyle}{}{\thepage}{}% Odd page footer
    % \pagestyle{mypagestyle}
    % \aliaspagestyle{title}{mypagestyle}

    % Heading styles

    % \makechapterstyle{adamschapter}{
    %     \renewcommand{\printchaptername}{}
    %     \renewcommand{\chapternamenum}{}
    %     \renewcommand{\chapnumfont}{\normalfont\Huge\bfseries}
    %     \renewcommand{\printchapternum}{\chapnumfont \thechapter.\space}
    %     \renewcommand{\afterchapternum}{}
    % }
    % %\chapterstyle{dash}
    % \chapterstyle{adamschapter}
    % \setlength{\beforechapskip}{25pt} % Remove extra spacing before chapter
    % \setlength{\midchapskip}{0pt}
    % \setlength{\afterchapskip}{15pt}

    % % \makeheadstyles{adamsheads}{
    % %     \renewcommand*{\chapnamefont}{\normalfont\huge\bfseries}
    % %     \renewcommand*{\chapnumfont}{\normalfont\huge\bfseries}
    % %     \renewcommand*{\chaptitlefont}{\normalfont\Huge\bfseries}
    % % }
    % %\headstyles{default}
    % \headstyles{adams}

\fi

%% ############################################################################
%% ##################### BEAMER ###############################################
%% ############################################################################
\if@beamer

    \usetheme[height=0mm]{Rochester}
    \usecolortheme[RGB={71,98,176}]{structure}
    \useoutertheme[subsection=false]{miniframes}
    \useinnertheme{rectangles}

    \setbeamercovered{transparent}
    \setbeamertemplate{navigation symbols}{} % no navigation symbols

    \setbeamerfont{title like}{shape=\scshape} % small caps
    \setbeamerfont{frametitle}{shape=\Large}
    \addtobeamertemplate{frametitle}{}{\vspace{-1em}} % smaller top margin (after title)

    %% COLORING
    \setbeamercolor*{structure}{fg=black}
    \setbeamercolor*{frametitle}{fg=black,bg=white}
    \setbeamercolor*{button}{fg=black}
    \setbeamercolor*{palette tertiary}{fg=black,bg=black!10}
    \setbeamercolor*{palette quaternary}{fg=black,bg=black!10}

    %% FOOTNOTES
    % allow footnote without number
    \newcommand\blankfootnote[1]{%
      \begingroup
      \renewcommand\thefootnote{}\footnote{#1}%
      \addtocounter{footnote}{-1}%
      \endgroup
    }
    \renewcommand*\footnoterule{} % remove footnote ruler
    \setbeamerfont{footnote}{size=\scriptsize}

    % we dont use enumitem since it breaks beamer
    %\setlist[itemize,1]{itemsep=1em}        % When using enumitem this is needed
    %\setlist[itemize]{label=\scriptsize$\blacksquare$}
    \setbeamertemplate{itemize item}{\scriptsize\raise1.25pt\hbox{\donotcoloroutermaths$\blacksquare$}}
    \setbeamertemplate{itemize subitem}{\tiny\raise1.5pt\hbox{\donotcoloroutermaths$\blacktriangleright$}}
    \setbeamertemplate{itemize subsubitem}{\tiny\raise1.5pt\hbox{\donotcoloroutermaths$\blacktriangleright$}}

    \setbeamertemplate{enumerate item}[square]
    %\setbeamercolor{item projected}{bg=black,fg=white}

    % This code makes miniframe signs (small black circles) be on same row as sections
    \makeatletter
        \patchcmd{\slideentry}{\advance\beamer@tempdim by -.05cm}{\advance\beamer@tempdim by\beamer@vboxoffset\advance\beamer@tempdim by\beamer@boxsize\advance\beamer@tempdim by 0.9\pgflinewidth}{}{}
        \patchcmd{\slideentry}{\kern\beamer@tempdim}{\advance\beamer@tempdim by 2pt\advance\beamer@tempdim by\wd\beamer@sectionbox\kern\beamer@tempdim}{}{}
    \makeatother

    % %% TOC
    \setbeamerfont{tocfont}{series=\bfseries,size=\Large}

    % Larger buttons
    \setbeamertemplate{button}{\tikz
      \node[
      inner xsep=5pt,
      draw=structure!95,
      fill=white,
      yshift=7pt,
      xshift=0pt,
      rounded corners=3pt]  {\normalsize\insertbuttontext};}

    % %% FOOTER
    % % \useoutertheme{infolines}
    % \beamertemplatenavigationsymbolsempty   % No navigation
    % % \setfootline{
    % %     \insertshortinstitute, \insertshortdate
    % %     \hfill slide \insertframenumber/\inserttotalframenumber
    % % }
    %     \setbeamertemplate{footline}
    %     {
    %       \leavevmode%
    %       \hbox{%
    %       \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{author in head/foot}%
    %         \usebeamerfont{author in head/foot}\insertsection
    %       \end{beamercolorbox}%
    %       \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{title in head/foot}%
    %         \usebeamerfont{title in head/foot}\insertsubsection
    %       \end{beamercolorbox}%
    %       \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,right]{date in head/foot}%
    %         \usebeamerfont{date in head/foot}\insertshortdate{}\hspace*{2em}
    %         \insertframenumber{} / \inserttotalframenumber\hspace*{2ex}
    %       \end{beamercolorbox}}%
    %       \vskip0pt%
    %     }
    %     \makeatother

    % Footnote on right side
    \setbeamertemplate{footnote}{%
        \parindent 0em\noindent%
        \raggedleft%\raggedright
        \usebeamercolor{footnote}\hbox to 0.8em{\hfil\insertfootnotemark}\insertfootnotetext\par%
    }

\fi

\endinput
